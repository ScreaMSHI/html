<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>::: 有限认知分部 / 非标准连接 :::</title>
    <!-- 引入 Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 使用 Inter 字体作为基准，但通过 CSS Glitch 效果进行风格化 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* 自定义故障（Glitch）动画 */
        .glitch-text {
            font-family: 'Inter', sans-serif;
            text-shadow: 
                1px 0 0 #f0f, 
                -2px 0 0 #0ff;
            animation: 
                glitch-anim-1 2s infinite alternate-reverse linear,
                flicker 0.1s infinite;
        }

        .glitch-text::before,
        .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            clip: rect(0, 900px, 0, 0);
        }

        .glitch-text::before {
            text-shadow: 3px 0 0 #ff00ff;
            animation: glitch-anim-2 3s infinite alternate-reverse linear;
        }

        .glitch-text::after {
            text-shadow: -3px 0 0 #00ffff;
            animation: glitch-anim-3 4s infinite alternate-reverse linear;
        }

        @keyframes glitch-anim-1 {
            0% { clip: rect(24px, 9999px, 83px, 0); transform: skew(0.5deg); }
            10% { clip: rect(51px, 9999px, 60px, 0); transform: skew(0.1deg); }
            20% { clip: rect(33px, 9999px, 39px, 0); transform: skew(1.2deg); }
            30% { clip: rect(72px, 9999px, 73px, 0); transform: skew(0.7deg); }
            40% { clip: rect(28px, 9999px, 94px, 0); transform: skew(-0.5deg); }
            50% { clip: rect(10px, 9999px, 31px, 0); transform: skew(0.2deg); }
            60% { clip: rect(65px, 9999px, 72px, 0); transform: skew(-1.1deg); }
            70% { clip: rect(88px, 9999px, 99px, 0); transform: skew(0.9deg); }
            80% { clip: rect(14px, 9999px, 57px, 0); transform: skew(-0.8deg); }
            90% { clip: rect(30px, 9999px, 80px, 0); transform: skew(0.3deg); }
            100% { clip: rect(18px, 9999px, 45px, 0); transform: skew(-0.2deg); }
        }

        @keyframes glitch-anim-2 {
            0% { clip: rect(31px, 9999px, 40px, 0); transform: translate(-5px); }
            20% { clip: rect(79px, 9999px, 90px, 0); transform: translate(5px); }
            40% { clip: rect(10px, 9999px, 20px, 0); transform: translate(-10px); }
            60% { clip: rect(50px, 9999px, 60px, 0); transform: translate(10px); }
            80% { clip: rect(95px, 9999px, 105px, 0); transform: translate(-5px); }
            100% { clip: rect(22px, 9999px, 33px, 0); transform: translate(5px); }
        }

        @keyframes glitch-anim-3 {
            0% { clip: rect(54px, 9999px, 63px, 0); transform: translate(5px); }
            20% { clip: rect(12px, 9999px, 20px, 0); transform: translate(-5px); }
            40% { clip: rect(70px, 9999px, 80px, 0); transform: translate(10px); }
            60% { clip: rect(35px, 9999px, 45px, 0); transform: translate(-10px); }
            80% { clip: rect(88px, 9999px, 98px, 0); transform: translate(5px); }
            100% { clip: rect(41px, 9999px, 51px, 0); transform: translate(-5px); }
        }

        @keyframes flicker {
            0% { opacity: 0.9; }
            5% { opacity: 0.8; }
            10% { opacity: 1; }
            15% { opacity: 0.7; }
            20% { opacity: 1; }
            25% { opacity: 0.8; }
            30% { opacity: 0.9; }
            100% { opacity: 1; }
        }

        .no-glitch {
            animation: none !important;
            text-shadow: none !important;
        }

        /* 隐藏滚动条但允许内容滚动 */
        body {
            overflow-y: scroll;
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }

        body::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }
        
        /* 隐藏 Details 箭头 */
        details > summary::-webkit-details-marker {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-900 text-cyan-400 font-mono tracking-wider">

    <!-- 1. 标题/加载页面 - 故障模式 -->
    <div id="splash-screen" class="min-h-screen h-screen w-full flex flex-col justify-center items-center p-6 transition-opacity duration-1000">
        <div class="max-w-md w-full text-center">
            
            <!-- 标题：::: 有限认知分部 / 非标准连接 ::: (Glitch Effect) -->
            <h1 id="glitch-title" data-text="::: 有限认知分部 / 非标准连接 :::" 
                class="glitch-text relative text-4xl sm:text-5xl font-bold mb-10 leading-tight inline-block mx-auto text-center">
                ::: 有限认知分部 / 非标准连接 :::
            </h1>
            
            <!-- 快速变化的时间条 (已移除 [ 纪元时间戳 ] 标签) -->
            <div class="text-xl sm:text-2xl mb-8 p-3 border-2 border-cyan-400/50 bg-gray-800/50 shadow-lg shadow-cyan-500/20">
                <!-- 仅保留闪烁的数字 -->
                <span id="glitch-time" class="text-yellow-400 glitch-text" data-text="0000.00.00 00:00:00">0000.00.00 00:00:00</span>
            </div>

            <!-- 确认接入指令 按钮 -->
            <button id="sync-button" 
                    class="w-full py-3 px-6 text-lg bg-cyan-600 hover:bg-cyan-700 active:bg-cyan-800 text-gray-900 font-bold rounded-lg shadow-xl shadow-cyan-500/50 transform transition duration-300 hover:scale-[1.01] disabled:opacity-50 disabled:cursor-not-allowed">
                确认接入指令
            </button>

            <!-- 加载进度条 -->
            <div id="loading-container" class="mt-8 hidden">
                <p class="text-sm mb-2 text-cyan-400/70">正在重写时间线参数...</p>
                <div class="w-full h-3 bg-gray-700 rounded-full overflow-hidden border border-cyan-400/30">
                    <div id="loading-bar" class="h-full bg-green-500 transition-all duration-100 ease-linear" style="width: 0%"></div>
                </div>
                <p id="loading-text" class="text-xs mt-2 text-green-400">0%</p>
            </div>
            
        </div>
        
        <!-- 加载完成后显示的向下箭头 -->
        <a id="scroll-indicator" href="#content-start" class="hidden absolute bottom-8 animate-bounce text-4xl text-green-500/80 hover:text-green-400 transition-colors duration-300">
            &#x2B07; <!-- Unicode for Down Arrow -->
        </a>
    </div>

    <!-- 2. 主内容模块 -->
    <div id="main-content" class="min-h-screen bg-gray-900 p-6 sm:p-12 transition-opacity duration-1000 opacity-0 pointer-events-none">
        <a id="content-start" class="invisible"></a>

        <!-- 导言 (已恢复为用户指定的静态文本) -->
        <div class="max-w-4xl mx-auto mb-16 border-b border-cyan-400/30 pb-8">
            <h2 id="final-time-h2" class="text-3xl font-bold text-red-500/80 mb-4 tracking-wider">::: 认知稳定，权限开放 :::</h2>
            <p class="text-gray-300 text-lg leading-relaxed">
                当前数据同步至纪元2012年11月。以下信息已通过校验，但其真实性与源头稳定性仍处于低置信区间。请按需查阅，并严格遵循既定信息使用协议。
            </p>
        </div>

        <!-- 模块 1: 补给仓库 (Supply Depot) -->
        <div class="max-w-4xl mx-auto mb-16">
            <h3 class="text-2xl font-bold text-cyan-400 border-b border-cyan-400 pb-2 mb-6"># 补给仓库 [001.01]</h3>
            
            <!-- 简略目录 -->
            <div class="bg-gray-800 p-4 mb-6 rounded-lg border border-gray-700">
                <p class="text-sm text-gray-500 mb-2">:: 目录索引 ::</p>
                <p class="text-sm text-gray-400">
                    <span class="mr-4">A-01: 游戏地图</span> | 
                    <span class="mr-4">A-02: 记忆碎片</span> | 
                    <span class="mr-4">B-03: 异常源定位器</span>
                </p>
            </div>

            <!-- 可展开的小模块 (Accordion Style) -->
            <div class="space-y-4">
                
                <!-- A-01: 游戏地图 (价格改为非交互式徽章) -->
                <details class="bg-gray-800 rounded-lg shadow-lg overflow-hidden transition-all duration-300 open:shadow-cyan-500/30 border border-cyan-500/20">
                    <!-- 非交互式价格标签和指示器位于 Summary 内部右侧 -->
                    <summary class="flex justify-between items-center p-4 cursor-pointer hover:bg-gray-700 transition-colors duration-200 text-yellow-300 font-bold">
                        <span>[ A-01 ] 游戏地图 (Game Map)</span>
                        <div class="flex items-center space-x-4">
                            <!-- 非交互式价格徽章 (Badge) -->
                            <span class="px-3 py-1 text-xs bg-gray-700 text-green-400 font-semibold rounded-full border border-green-500/50 tracking-wider">
                                $25
                            </span>
                            <!-- 展开/收起指示器 -->
                            <span class="text-xl transform transition-transform duration-300 summary-indicator">&#x25BC;</span>
                        </div>
                    </summary>
                    <div class="p-4 bg-gray-900 text-gray-400 border-t border-cyan-500/20">
                        <p class="text-sm leading-relaxed mb-4">
                            一张以携带者为中心，半径500m，随移动实时更新的像素风格地图。可以显示附近道路、墙壁、河流、房间等的基本布局。地图范围内的平凡生命会以小人图标标记，并标出其视野范围。
                            <br><br>
                            特工可以消耗一点任意品质（Quality）的素质保证（Quality Assurance），来实现一项以下功能：
                        </p>
                        <!-- 使用自定义的右三角箭头 (►) 作为列表标记 -->
                        <ul class="text-sm list-none pl-4 space-y-2">
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2 mt-px text-sm">►</span>
                                <span>标记一个目标持续跟踪其位置（超出范围会以小箭头标记大概方向）</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2 mt-px text-sm">►</span>
                                <span>显示两点之间的一条较短可用道路</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2 mt-px text-sm">►</span>
                                <span>原地建立传送锚点</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-400 mr-2 mt-px text-sm">►</span>
                                <span>在明显的10秒读条效果后前往传送锚点</span>
                            </li>
                        </ul>
                        
                    </div>
                </details>

                <!-- A-02: 记忆碎片包 -->
                <details class="bg-gray-800 rounded-lg shadow-lg overflow-hidden transition-all duration-300 border border-cyan-500/20">
                    <summary class="flex justify-between items-center p-4 cursor-pointer hover:bg-gray-700 transition-colors duration-200 text-yellow-300 font-bold">
                        <span>[ A-02 ] 记忆碎片包 (Memory Shard Pack)</span>
                        <span class="text-xl transform transition-transform duration-300 summary-indicator">&#x25BC;</span>
                    </summary>
                    <div class="p-4 bg-gray-900 text-gray-400 border-t border-cyan-500/20">
                        <p class="text-sm">
                            由回收站回收的无用信息片段，经高熵处理后用于掩盖敏感数据。使用时可能会触发随机且毫无意义的童年记忆或过往人生路径。
                        </p>
                    </div>
                </details>
                
                <!-- B-03 模块：背景色已还原为标准深灰，标题字体颜色更改为红色 -->
                <details class="bg-gray-800 rounded-lg shadow-lg overflow-hidden transition-all duration-300 open:shadow-yellow-500/30 border border-yellow-500/20">
                    <summary class="flex justify-between items-center p-4 cursor-pointer hover:bg-gray-700 transition-colors duration-200 text-red-400 font-bold">
                        <span>[ B-03 ] 异常源定位器 (Anomaly Locator)</span>
                        <span class="text-xl transform transition-transform duration-300 summary-indicator">&#x25BC;</span>
                    </summary>
                    <div class="p-4 bg-gray-900 text-gray-400 border-t border-yellow-500/20">
                        <p class="text-sm">
                            一个校准频率偏移的设备。请注意，它找到的“异常”可能只是你所处时间线的正常现象。设备状态：不稳定，持续过热。
                        </p>
                    </div>
                </details>
            </div>
        </div>

        <!-- 模块 2: 组织阵营 (Organizational Factions) -->
        <div class="max-w-4xl mx-auto mb-16">
            <h3 class="text-2xl font-bold text-cyan-400 border-b border-cyan-400 pb-2 mb-6"># 组织阵营 [002.01]</h3>
            
            <!-- 标签切换 (Tabs) -->
            <div id="factions-tabs" class="flex space-x-2 sm:space-x-4 mb-6 overflow-x-auto pb-2">
                <button data-faction="division" class="tab-button active-tab">有限认知分部</button>
                <button data-faction="syndicate" class="tab-button">灰质财团</button>
                <button data-faction="watchers" class="tab-button">时空观察者</button>
            </div>

            <!-- 阵营简介内容 -->
            <div id="faction-content-division" class="faction-content bg-gray-800 p-6 rounded-xl border border-red-500/30 shadow-2xl shadow-red-500/10">
                <h4 class="text-xl text-red-400 font-bold mb-3">有限认知分部 (The Division)</h4>
                <p class="text-gray-400 text-sm leading-relaxed">
                    本部门。致力于在多重时间线的混乱中，建立一个“有限但可控”的认知框架。我们的目标不是理解宇宙，而是防止它彻底崩溃成一堆无法被人类心智处理的矛盾。核心原则：无知即稳定。
                </p>
            </div>

            <div id="faction-content-syndicate" class="faction-content hidden bg-gray-800 p-6 rounded-xl border border-red-500/30">
                <h4 class="text-xl text-red-400 font-bold mb-3">灰质财团 (Grey Matter Syndicate)</h4>
                <p class="text-gray-400 text-sm leading-relaxed">
                    一个利用异常现象进行非法时间线交易的实体。他们贩卖“预知片段”和“因果债券”，将现实的确定性视为可交易的商品。高度危险，涉嫌多起现实结构局部坍塌事件。
                </p>
            </div>

            <div id="faction-content-watchers" class="faction-content hidden bg-gray-800 p-6 rounded-xl border border-red-500/30">
                <h4 class="text-xl text-red-400 font-bold mb-3">时空观察者 (The Chronal Watchers)</h4>
                <p class="text-gray-400 text-sm leading-relaxed">
                    自称是“原始时间线维护者”。他们漂浮在所有时间线的边缘，只记录、不干预。对他们的存在尚无确切证据，但他们的记录偶尔会以加密数据的形式渗透到我们的网络中。
                </p>
            </div>
        </div>

        <!-- 模块 3: 机密档案 (Confidential Archives) -->
        <div class="max-w-4xl mx-auto mb-16">
            <h3 class="text-2xl font-bold text-cyan-400 border-b border-cyan-400 pb-2 mb-6"># 机密档案库 [003.01]</h3>
            
            <div id="archives-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- 档案 1: 碎裂星云事件 -->
                <div class="archive-card bg-gray-800 rounded-lg overflow-hidden shadow-lg border border-cyan-500/30 cursor-pointer hover:shadow-cyan-500/50 transition-all duration-300">
                    <div class="p-4">
                        <h4 class="text-lg font-bold text-red-400 mb-2">档案: S-77</h4>
                        <p class="text-sm text-gray-500 mb-3">碎裂星云事件报告</p>
                        <p class="text-xs text-gray-400 line-clamp-3">
                            <span class="text-yellow-400">摘要:</span> 2012年11月，在欧洲上空监测到无法解释的重力场波动，导致短暂的物理定律松弛。报告提及“天空如玻璃般破碎”的目击者描述。文件容量：极高。
                        </p>
                    </div>
                    <button class="expand-button w-full bg-gray-700 py-2 text-sm text-cyan-300 hover:bg-cyan-700 hover:text-gray-900 transition-colors duration-200" data-id="archive1">
                        展开文本
                    </button>
                </div>

                <!-- 档案 2: 非物质信使 -->
                <div class="archive-card bg-gray-800 rounded-lg overflow-hidden shadow-lg border border-cyan-500/30 cursor-pointer hover:shadow-cyan-500/50 transition-all duration-300">
                    <div class="p-4">
                        <h4 class="text-lg font-bold text-red-400 mb-2">档案: P-19</h4>
                        <p class="text-sm text-gray-500 mb-3">非物质信使实验记录</p>
                        <p class="text-xs text-gray-400 line-clamp-3">
                            <span class="text-yellow-400">摘要:</span> 对一种无法被电磁波段捕获的“信使”的持续研究。信使似乎携带了来自未来或过去的道德指令。所有尝试解码的探员都出现了同一种手部震颤。
                        </p>
                    </div>
                    <button class="expand-button w-full bg-gray-700 py-2 text-sm text-cyan-300 hover:bg-cyan-700 hover:text-gray-900 transition-colors duration-200" data-id="archive2">
                        展开文本
                    </button>
                </div>

                <!-- 档案 3: 循环梦境 -->
                <div class="archive-card bg-gray-800 rounded-lg overflow-hidden shadow-lg border border-cyan-500/30 cursor-pointer hover:shadow-cyan-500/50 transition-all duration-300">
                    <div class="p-4">
                        <h4 class="text-lg font-bold text-red-400 mb-2">档案: M-04</h4>
                        <p class="text-sm text-gray-500 mb-3">循环梦境个体评估</p>
                        <p class="text-xs text-gray-400 line-clamp-3">
                            <span class="text-yellow-400">摘要:</span> 对一名声称每天晚上都在同一个地点、做同一件事（吃一个不存在的苹果）的个体的评估报告。该个体似乎是时间线循环的稳定锚点。
                        </p>
                    </div>
                    <button class="expand-button w-full bg-gray-700 py-2 text-sm text-cyan-300 hover:bg-cyan-700 hover:text-gray-900 transition-colors duration-200" data-id="archive3">
                        展开文本
                    </button>
                </div>
            </div>

            <!-- 档案展开区域 -->
            <div id="expanded-archive-area" class="mt-8 p-6 bg-gray-900 border-2 border-red-500/50 rounded-lg shadow-xl shadow-red-500/20 hidden">
                <h4 id="expanded-archive-title" class="text-2xl text-red-400 mb-4 border-b border-red-500/30 pb-2"></h4>
                <p id="expanded-archive-text" class="text-gray-300 whitespace-pre-wrap leading-loose text-sm"></p>
                <button id="close-archive-button" class="mt-4 px-4 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors duration-200">
                    [ 关闭档案 ]
                </button>
            </div>
        </div>
    </div>

    <script>
        const splashScreen = document.getElementById('splash-screen');
        const glitchTitle = document.getElementById('glitch-title');
        const glitchTime = document.getElementById('glitch-time');
        const syncButton = document.getElementById('sync-button');
        const loadingContainer = document.getElementById('loading-container');
        const loadingBar = document.getElementById('loading-bar');
        const loadingText = document.getElementById('loading-text');
        const scrollIndicator = document.getElementById('scroll-indicator');
        const mainContent = document.getElementById('main-content');
        const finalTimeH2 = document.getElementById('final-time-h2');
        
        let glitchInterval;
        let lastGlitchValue = 0;
        let isSyncing = false;

        // --- 数据存储 ---
        const ARCHIVE_DATA = {
            archive1: {
                title: "档案 S-77: 碎裂星云事件报告",
                text: "记录日期: 2012年11月22日 04:47:11\n\n[机密等级: 5/5 - 绝对不可知]\n\n事件摘要：位于格陵兰海的监测站记录到时空结构出现局部撕裂，持续时间约为4.3秒。目击者（一名渔民，代号'Maelstrom'）报告天空在撕裂期间呈现出'一万个时钟'同时破碎的景象。\n\n分析：重力常数在撕裂期间波动了±0.00000001%。这足以导致水分子在短时间内无法保持液态。任何企图通过常规手段理解此次事件的尝试都被判定为高风险的认知污染。建议将此档案标记为'非事件'，并在所有官方记录中将其替换为'天气反常'。",
            },
            archive2: {
                title: "档案 P-19: 非物质信使实验记录",
                text: "记录日期: 2012年11月10日 11:59:00\n\n[机密等级: 3/5 - 需授权]\n\n实验目的：捕获并分析代号'低语'的非物质信使。信使不遵循任何已知宇宙定律，通过潜意识共振传递信息。\n\n实验结果：信使传递的信息被探员L-03记录为一串二进制代码。解码后得到：'他们看到了你'。随后，L-03的手部开始出现不可控的、无规律的震颤。此震颤与心跳或呼吸均不相关。L-03已被隔离，信使被判定为具有高认知侵入性。实验终止，建议将所有捕获尝试降级为被动监测。",
            },
            archive3: {
                title: "档案 M-04: 循环梦境个体评估",
                text: "记录日期: 2012年11月05日 19:30:00\n\n[机密等级: 4/5 - 敏感]\n\n个体代号: '锚点'\n\n评估：锚点是一个活生生的、自洽的时间循环。他所处的梦境（位于一个不存在的灰色小镇，始终在一家咖啡馆里吃苹果）是他时间线中唯一稳定的点。如果锚点被唤醒或打破循环，该时间线将面临不可预测的重写风险。评估建议：保持距离，被动观察。如果他向你提及任何关于'正确的时钟'的信息，立即终止对话。",
            },
        };

        // --- 故障时间函数 ---

        function formatTargetTime(date) {
            const year = String(date.getFullYear()).padStart(4, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            return `${year}/${month}/XX`; // 隐藏日期
        }
        
        function updateGlitchTime() {
            if (isSyncing) return;

            const now = new Date();
            const baseTime = now.getTime();
            
            // 生成一个不合理的、快速变化的数字，作为时间条的“纪元时间戳”
            const offset = Math.floor(Math.random() * 9999999999999999);
            const glitchDate = new Date(baseTime + offset);
            
            // 生成一个随机的小数字，避免数字变化停滞
            const randomChange = Math.random() * 50 - 25; // 变化范围 -25 to 25
            lastGlitchValue += randomChange;
            
            // 用当前时间结构包裹随机纪元
            let year = String(glitchDate.getFullYear()).slice(-4);
            let month = String(glitchDate.getMonth() + 1).padStart(2, '0');
            let day = String(glitchDate.getDate()).padStart(2, '0');
            let hour = String(glitchDate.getHours()).padStart(2, '0');
            let minute = String(glitchDate.getMinutes()).padStart(2, '0');
            let second = String(glitchDate.getSeconds()).padStart(2, '0');

            // 故意引入数字错乱效果
            const dateString = `${year}.${month}.${day} ${hour}:${minute}:${second}`;
            let glitchedString = '';
            for (let i = 0; i < dateString.length; i++) {
                if (Math.random() < 0.15) { // 15%的概率替换为随机数字
                    glitchedString += Math.floor(Math.random() * 10);
                } else if (Math.random() < 0.05) { // 5%的概率替换为特殊字符
                    glitchedString += (i % 3 === 0) ? ':' : '.';
                } else {
                    glitchedString += dateString[i];
                }
            }

            glitchTime.textContent = glitchedString;
            glitchTime.setAttribute('data-text', glitchedString);
        }

        // --- 同步函数 ---

        function synchronizeTimeline() {
            if (isSyncing) return;
            isSyncing = true;
            syncButton.disabled = true;
            // 按钮文本更改：从 “确认接入指令” 到 “正在执行指令...”
            syncButton.textContent = '正在执行指令...'; 
            loadingContainer.classList.remove('hidden');
            
            // 停止故障时间更新
            clearInterval(glitchInterval);

            // 移除故障CSS类
            glitchTitle.classList.remove('glitch-text');
            glitchTime.classList.remove('glitch-text');
            glitchTitle.classList.add('no-glitch');
            glitchTime.classList.add('no-glitch');

            let progress = 0;
            const duration = 2500; // 2.5秒加载
            const startTime = performance.now();

            function animateLoading(currentTime) {
                if (progress >= 100) return;

                const elapsed = currentTime - startTime;
                progress = Math.min(100, (elapsed / duration) * 100);
                
                loadingBar.style.width = `${progress}%`;
                loadingText.textContent = `${Math.floor(progress)}%`;

                if (progress < 100) {
                    requestAnimationFrame(animateLoading);
                } else {
                    finishSynchronization();
                }
            }
            
            requestAnimationFrame(animateLoading);
        }

        function finishSynchronization() {
            const now = new Date();
            
            // 计算目标时间: 2012年11月 (保留计算，但不用于更新H2标题)
            const targetDate = new Date(now);
            targetDate.setFullYear(2012);
            targetDate.setMonth(10); // 10 is November

            // 按钮文本更改：从 “正在执行指令...” 到 “接入已确认”
            syncButton.textContent = '接入已确认';
            syncButton.classList.remove('bg-cyan-600', 'hover:bg-cyan-700');
            syncButton.classList.add('bg-green-600');
            
            // 显示向下箭头
            scrollIndicator.classList.remove('hidden');
            
            // 平滑过渡到主内容可读状态
            setTimeout(() => {
                splashScreen.classList.add('opacity-0', 'pointer-events-none', 'absolute');
                mainContent.classList.remove('opacity-0', 'pointer-events-none');
            }, 1000); // 等待1秒让用户看到最终状态
        }

        // --- 模块 2: 组织阵营 逻辑 ---

        const tabButtons = document.querySelectorAll('.tab-button');
        const factionContents = document.querySelectorAll('.faction-content');
        const defaultActiveFaction = 'division';

        // 样式初始化
        tabButtons.forEach(button => {
            button.className = 'tab-button px-4 py-2 text-sm sm:text-base rounded-md font-semibold transition-colors duration-200 bg-gray-700 text-cyan-400 hover:bg-cyan-800/50';
        });

        const activeTabClass = 'bg-red-600 text-white shadow-lg shadow-red-500/30 hover:bg-red-700';

        function switchFaction(factionId) {
            factionContents.forEach(content => {
                content.classList.add('hidden');
                content.classList.remove('shadow-2xl', 'shadow-red-500/10');
            });

            tabButtons.forEach(button => {
                button.classList.remove(...activeTabClass.split(' '));
                button.classList.add('bg-gray-700', 'text-cyan-400');
            });

            document.getElementById(`faction-content-${factionId}`).classList.remove('hidden');
            document.getElementById(`faction-content-${factionId}`).classList.add('shadow-2xl', 'shadow-red-500/10');
            document.querySelector(`.tab-button[data-faction="${factionId}"]`).classList.add(...activeTabClass.split(' '));
            document.querySelector(`.tab-button[data-faction="${factionId}"]`).classList.remove('bg-gray-700', 'text-cyan-400');
        }

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                switchFaction(button.getAttribute('data-faction'));
            });
        });

        // 初始激活默认标签
        switchFaction(defaultActiveFaction);


        // --- 模块 3: 机密档案 逻辑 ---

        const expandButtons = document.querySelectorAll('.expand-button');
        const expandedArchiveArea = document.getElementById('expanded-archive-area');
        const expandedArchiveTitle = document.getElementById('expanded-archive-title');
        const expandedArchiveText = document.getElementById('expanded-archive-text');
        const closeArchiveButton = document.getElementById('close-archive-button');

        expandButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                const archiveId = e.target.getAttribute('data-id');
                const data = ARCHIVE_DATA[archiveId];
                
                expandedArchiveTitle.textContent = data.title;
                expandedArchiveText.textContent = data.text;
                expandedArchiveArea.classList.remove('hidden');
                
                // 滚动到档案区域
                expandedArchiveArea.scrollIntoView({ behavior: 'smooth' });
            });
        });

        closeArchiveButton.addEventListener('click', () => {
            expandedArchiveArea.classList.add('hidden');
            expandedArchiveTitle.textContent = '';
            expandedArchiveText.textContent = '';
        });

        // --- 初始化事件监听 ---
        
        // 确保 Details 展开时，箭头方向变化
        document.querySelectorAll('details').forEach(details => {
            details.addEventListener('toggle', () => {
                const indicator = details.querySelector('.summary-indicator');
                if (details.open) {
                    indicator.style.transform = 'rotate(180deg)';
                } else {
                    indicator.style.transform = 'rotate(0deg)';
                }
            });
        });

        syncButton.addEventListener('click', synchronizeTimeline);

        // 页面加载完成后启动故障时间更新
        window.onload = function() {
            updateGlitchTime(); // 立即执行一次
            glitchInterval = setInterval(updateGlitchTime, 100); // 每100ms更新一次
        }
    </script>
</body>
</html>